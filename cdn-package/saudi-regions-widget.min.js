/**
 * Saudi Regions Widget Enhanced v2.0.0
 * Built on 2025-09-18T14:30:21.533Z
 * https://github.com/YounisDany/saudi-regions-widget
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.SaudiRegionsWidget=t()}("undefined"!=typeof self?self:this,function(){"use strict";const e={dataUrl:"https://cdn.jsdelivr.net/gh/YounisDany/saudi-regions-widget@main/dist/data/",dataLevel:"regions-cities",language:"ar",rtl:!0,searchEnabled:!0,placeholder:{ar:{region:"اختر المنطقة",city:"اختر المدينة",district:"اختر الحي"},en:{region:"Select Region",city:"Select City",district:"Select District"}},classes:{container:"saudi-widget-container",select:"saudi-widget-select",search:"saudi-widget-search",option:"saudi-widget-option"}};class SaudiRegionsWidget{constructor(t={}){this.config={...e,...t},this.data=null,this.elements={},this.callbacks={},this.isLoaded=!1,this.init()}async init(){try{await this.loadData(),this.isLoaded=!0,this.trigger("ready")}catch(e){console.error("Saudi Regions Widget: Failed to initialize",e),this.trigger("error",e)}}async loadData(){const e=this.config.dataLevel+".min.json",t=this.config.dataUrl+e;try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);this.data=await e.json(),this.trigger("dataLoaded",this.data)}catch(e){throw console.error("Saudi Regions Widget: Failed to load data",e),e}}createRegionSelect(e,t={}){const i=document.getElementById(e);if(!i)throw new Error(`Container with id "${e}" not found`);const a={...this.config,...t},s=this.createSelectElement("region",a);return this.populateRegions(s,a),i.appendChild(s),this.elements[e]={region:s},s}createCascadingSelects(e,t={}){const i=document.getElementById(e);if(!i)throw new Error(`Container with id "${e}" not found`);const a={...this.config,...t},s=document.createElement("div");s.className=a.classes.container,a.rtl&&(s.dir="rtl");const n=this.createSelectElement("region",a),c=this.createSelectElement("city",a),o=this.createSelectElement("district",a);return c.disabled=!0,o.disabled=!0,this.populateRegions(n,a),n.addEventListener("change",e=>{const t=e.target.value;this.populateCities(c,t,a),this.resetSelect(o,a,"district"),o.disabled=!0,this.trigger("regionChanged",{regionId:t,region:this.getRegionById(t)})}),c.addEventListener("change",e=>{const t=e.target.value,i=n.value;"complete"===this.config.dataLevel&&this.populateDistricts(o,i,t,a),this.trigger("cityChanged",{cityId:t,city:this.getCityById(t)})}),o.addEventListener("change",e=>{const t=e.target.value;this.trigger("districtChanged",{districtId:t,district:this.getDistrictById(t)})}),s.appendChild(n),s.appendChild(c),"complete"===this.config.dataLevel&&s.appendChild(o),i.appendChild(s),this.elements[e]={container:s,region:n,city:c,district:o},{container:s,region:n,city:c,district:o}}createSelectElement(e,t){const i=document.createElement("select");i.className=t.classes.select+" "+t.classes.select+"-"+e;const a=document.createElement("option");return a.value="",a.textContent=t.placeholder[t.language][e],a.disabled=!0,a.selected=!0,i.appendChild(a),i}populateRegions(e,t){this.resetSelect(e,t,"region");("complete"===this.config.dataLevel?Object.values(this.data).map(e=>e.region):Object.values(this.data.regions||this.data)).forEach(i=>{const a=document.createElement("option");a.value=i.id,a.textContent="ar"===t.language?i.name_ar:i.name_en,a.className=t.classes.option,e.appendChild(a)})}populateCities(e,t,i){if(this.resetSelect(e,i,"city"),!t)return void(e.disabled=!0);let a=[];"complete"===this.config.dataLevel?a=Object.values(this.data[t]?.cities||{}):this.data.cities&&(a=Object.values(this.data.cities).filter(e=>e.region_id==t)),a.forEach(t=>{const a=document.createElement("option");a.value=t.id,a.textContent="ar"===i.language?t.name_ar:t.name_en,a.className=i.classes.option,e.appendChild(a)}),e.disabled=0===a.length}populateDistricts(e,t,i,a){if(this.resetSelect(e,a,"district"),!t||!i)return void(e.disabled=!0);const s=Object.values(this.data[t]?.cities[i]?.districts||{});s.forEach(t=>{const i=document.createElement("option");i.value=t.id,i.textContent="ar"===a.language?t.name_ar:t.name_en,i.className=a.classes.option,e.appendChild(i)}),e.disabled=0===s.length}resetSelect(e,t,i){e.innerHTML="";const a=document.createElement("option");a.value="",a.textContent=t.placeholder[t.language][i],a.disabled=!0,a.selected=!0,e.appendChild(a)}getRegionById(e){return"complete"===this.config.dataLevel?this.data[e]?.region:this.data.regions?.[e]||this.data[e]}getCityById(e){if("complete"===this.config.dataLevel)for(const t of Object.values(this.data))if(t.cities[e])return t.cities[e];return this.data.cities?.[e]}getDistrictById(e){if("complete"===this.config.dataLevel)for(const t of Object.values(this.data))for(const i of Object.values(t.cities))if(i.districts[e])return i.districts[e];return null}search(e,t="all"){if(!this.data||!e)return[];const i=[],a=e.toLowerCase();if("all"===t||"regions"===t){("complete"===this.config.dataLevel?Object.values(this.data).map(e=>e.region):Object.values(this.data.regions||this.data)).forEach(e=>{(e.name_ar.toLowerCase().includes(a)||e.name_en.toLowerCase().includes(a))&&i.push({type:"region",data:e})})}if("all"===t||"cities"===t){let e=[];"complete"===this.config.dataLevel?Object.values(this.data).forEach(t=>{e=e.concat(Object.values(t.cities))}):this.data.cities&&(e=Object.values(this.data.cities)),e.forEach(e=>{(e.name_ar.toLowerCase().includes(a)||e.name_en.toLowerCase().includes(a))&&i.push({type:"city",data:e})})}return i}on(e,t){this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t)}off(e,t){if(this.callbacks[e]){const i=this.callbacks[e].indexOf(t);i>-1&&this.callbacks[e].splice(i,1)}}trigger(e,t){this.callbacks[e]&&this.callbacks[e].forEach(e=>e(t))}getSelections(e){const t=this.elements[e];return t?{region:{id:t.region?.value||null,data:this.getRegionById(t.region?.value)},city:{id:t.city?.value||null,data:this.getCityById(t.city?.value)},district:{id:t.district?.value||null,data:this.getDistrictById(t.district?.value)}}:null}setSelections(e,t){const i=this.elements[e];i&&(t.region&&(i.region.value=t.region,i.region.dispatchEvent(new Event("change"))),t.city&&setTimeout(()=>{i.city.value=t.city,i.city.dispatchEvent(new Event("change"))},100),t.district&&setTimeout(()=>{i.district.value=t.district,i.district.dispatchEvent(new Event("change"))},200))}destroy(e){if(this.elements[e]){const t=document.getElementById(e);t&&(t.innerHTML=""),delete this.elements[e]}}static getVersion(){return"2.0.0"}}return SaudiRegionsWidget.create=function(e){return new SaudiRegionsWidget(e)},SaudiRegionsWidget.createQuick=function(e,t={}){const i=new SaudiRegionsWidget(t);return i.on("ready",()=>{i.createCascadingSelects(e,t)}),i},SaudiRegionsWidget});