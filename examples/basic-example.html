<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saudi Regions Widget - مثال أساسي</title>
    <link rel="stylesheet" href="../dist/saudi-regions-widget.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f7fafc;
            direction: rtl;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        h1 {
            color: #2d3748;
            text-align: center;
            margin-bottom: 30px;
        }
        
        h2 {
            color: #4a5568;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 10px;
        }
        
        .example-section {
            margin-bottom: 40px;
        }
        
        .selections-display {
            background-color: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            font-family: monospace;
            direction: ltr;
            text-align: left;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #718096;
        }
        
        .error {
            background-color: #fed7d7;
            border: 1px solid #feb2b2;
            color: #c53030;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .success {
            background-color: #c6f6d5;
            border: 1px solid #9ae6b4;
            color: #2f855a;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        button {
            background-color: #4299e1;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        
        button:hover {
            background-color: #3182ce;
        }
        
        .search-section {
            margin-top: 20px;
        }
        
        .search-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 10px;
            box-sizing: border-box;
        }
        
        .search-results {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            background: white;
        }
        
        .search-result {
            padding: 10px;
            border-bottom: 1px solid #f1f5f9;
            cursor: pointer;
        }
        
        .search-result:hover {
            background-color: #f7fafc;
        }
        
        .search-result:last-child {
            border-bottom: none;
        }
        
        .result-type {
            font-size: 12px;
            color: #718096;
            text-transform: uppercase;
        }
    </style>
</head>
<body>
    <h1>🇸🇦 مكتبة المناطق السعودية المحسنة</h1>
    
    <div class="container">
        <h2>المثال الأساسي - اختيار متتالي</h2>
        <div id="loading1" class="loading">جاري تحميل البيانات...</div>
        <div id="widget1" style="display: none;"></div>
        <div class="selections-display" id="selections1">
            لم يتم اختيار أي عنصر بعد
        </div>
    </div>
    
    <div class="container">
        <h2>مثال مع المناطق فقط</h2>
        <div id="loading2" class="loading">جاري تحميل البيانات...</div>
        <div id="widget2" style="display: none;"></div>
        <div class="selections-display" id="selections2">
            لم يتم اختيار أي منطقة بعد
        </div>
    </div>
    
    <div class="container">
        <h2>البحث في البيانات</h2>
        <div class="search-section">
            <input type="text" id="searchInput" class="search-input" placeholder="ابحث عن منطقة أو مدينة...">
            <div id="searchResults" class="search-results" style="display: none;"></div>
        </div>
    </div>
    
    <div class="container">
        <h2>التحكم البرمجي</h2>
        <button onclick="setRiyadh()">اختيار الرياض</button>
        <button onclick="setMakkah()">اختيار مكة المكرمة</button>
        <button onclick="setJeddah()">اختيار جدة</button>
        <button onclick="clearSelections()">مسح الاختيارات</button>
    </div>

    <script src="../dist/saudi-regions-widget.js"></script>
    <script>
        let widget1, widget2, widget3;
        
        // Widget 1: Complete cascading selects
        widget1 = new SaudiRegionsWidget({
            dataLevel: 'complete',
            language: 'ar',
            rtl: true
        });
        
        widget1.on('ready', function() {
            document.getElementById('loading1').style.display = 'none';
            document.getElementById('widget1').style.display = 'block';
            widget1.createCascadingSelects('widget1');
        });
        
        widget1.on('regionChanged', function(data) {
            updateSelections('selections1');
        });
        
        widget1.on('cityChanged', function(data) {
            updateSelections('selections1');
        });
        
        widget1.on('districtChanged', function(data) {
            updateSelections('selections1');
        });
        
        widget1.on('error', function(error) {
            document.getElementById('loading1').innerHTML = 
                '<div class="error">خطأ في تحميل البيانات: ' + error.message + '</div>';
        });
        
        // Widget 2: Regions only
        widget2 = new SaudiRegionsWidget({
            dataLevel: 'regions',
            language: 'ar',
            rtl: true
        });
        
        widget2.on('ready', function() {
            document.getElementById('loading2').style.display = 'none';
            document.getElementById('widget2').style.display = 'block';
            const select = widget2.createRegionSelect('widget2');
            
            select.addEventListener('change', function(e) {
                const regionId = e.target.value;
                const region = widget2.getRegionById(regionId);
                document.getElementById('selections2').innerHTML = 
                    regionId ? JSON.stringify(region, null, 2) : 'لم يتم اختيار أي منطقة بعد';
            });
        });
        
        widget2.on('error', function(error) {
            document.getElementById('loading2').innerHTML = 
                '<div class="error">خطأ في تحميل البيانات: ' + error.message + '</div>';
        });
        
        // Widget 3: For search functionality
        widget3 = new SaudiRegionsWidget({
            dataLevel: 'regions-cities',
            language: 'ar'
        });
        
        widget3.on('ready', function() {
            setupSearch();
        });
        
        function updateSelections(elementId) {
            const selections = widget1.getSelections('widget1');
            document.getElementById(elementId).innerHTML = JSON.stringify(selections, null, 2);
        }
        
        function setupSearch() {
            const searchInput = document.getElementById('searchInput');
            const searchResults = document.getElementById('searchResults');
            
            searchInput.addEventListener('input', function(e) {
                const query = e.target.value.trim();
                
                if (query.length < 2) {
                    searchResults.style.display = 'none';
                    return;
                }
                
                const results = widget3.search(query);
                displaySearchResults(results);
            });
        }
        
        function displaySearchResults(results) {
            const searchResults = document.getElementById('searchResults');
            
            if (results.length === 0) {
                searchResults.innerHTML = '<div class="search-result">لا توجد نتائج</div>';
            } else {
                searchResults.innerHTML = results.map(result => `
                    <div class="search-result" onclick="selectSearchResult('${result.type}', ${result.data.id})">
                        <div class="result-type">${result.type === 'region' ? 'منطقة' : 'مدينة'}</div>
                        <div>${result.data.name_ar} - ${result.data.name_en}</div>
                    </div>
                `).join('');
            }
            
            searchResults.style.display = 'block';
        }
        
        function selectSearchResult(type, id) {
            document.getElementById('searchResults').style.display = 'none';
            document.getElementById('searchInput').value = '';
            
            if (type === 'region') {
                widget1.setSelections('widget1', { region: id });
            } else if (type === 'city') {
                // Find the region for this city first
                const city = widget3.getCityById(id);
                if (city) {
                    widget1.setSelections('widget1', { 
                        region: city.region_id, 
                        city: id 
                    });
                }
            }
        }
        
        // Programmatic control functions
        function setRiyadh() {
            widget1.setSelections('widget1', { region: 1, city: 3 });
        }
        
        function setMakkah() {
            widget1.setSelections('widget1', { region: 2, city: 6 });
        }
        
        function setJeddah() {
            // Find Jeddah city ID (you would need to search for it)
            const results = widget3.search('جدة');
            const jeddah = results.find(r => r.type === 'city' && r.data.name_ar === 'جدة');
            if (jeddah) {
                const city = jeddah.data;
                widget1.setSelections('widget1', { 
                    region: city.region_id, 
                    city: city.id 
                });
            }
        }
        
        function clearSelections() {
            widget1.destroy('widget1');
            widget1.createCascadingSelects('widget1');
        }
    </script>
</body>
</html>

