<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saudi Regions Widget - Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø­Ù„ÙŠ</title>
    <link rel="stylesheet" href="../dist/saudi-regions-widget.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f7fafc;
            direction: rtl;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        h1 {
            color: #2d3748;
            text-align: center;
            margin-bottom: 30px;
        }
        
        h2 {
            color: #4a5568;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 10px;
        }
        
        .example-section {
            margin-bottom: 40px;
        }
        
        .selections-display {
            background-color: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            font-family: monospace;
            direction: ltr;
            text-align: left;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #718096;
        }
        
        .error {
            background-color: #fed7d7;
            border: 1px solid #feb2b2;
            color: #c53030;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .success {
            background-color: #c6f6d5;
            border: 1px solid #9ae6b4;
            color: #2f855a;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        button {
            background-color: #4299e1;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        
        button:hover {
            background-color: #3182ce;
        }
        
        .test-results {
            background-color: #e6fffa;
            border: 1px solid #81e6d9;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .test-item {
            margin: 10px 0;
            padding: 8px;
            border-radius: 4px;
        }
        
        .test-pass {
            background-color: #c6f6d5;
            color: #2f855a;
        }
        
        .test-fail {
            background-color: #fed7d7;
            color: #c53030;
        }
    </style>
</head>
<body>
    <h1>ğŸ‡¸ğŸ‡¦ Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© - Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø­Ù„ÙŠ</h1>
    
    <div class="container">
        <h2>Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h2>
        <div id="loading-test" class="loading">Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>
        <div id="test-results" class="test-results" style="display: none;">
            <h3>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</h3>
            <div id="test-items"></div>
        </div>
    </div>
    
    <div class="container">
        <h2>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…ÙƒØªØ¨Ø© - Ø§Ø®ØªÙŠØ§Ø± Ù…ØªØªØ§Ù„ÙŠ</h2>
        <div id="loading1" class="loading">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>
        <div id="widget1" style="display: none;"></div>
        <div class="selections-display" id="selections1">
            Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø£ÙŠ Ø¹Ù†ØµØ± Ø¨Ø¹Ø¯
        </div>
    </div>
    
    <div class="container">
        <h2>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ ÙÙ‚Ø·</h2>
        <div id="loading2" class="loading">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>
        <div id="widget2" style="display: none;"></div>
        <div class="selections-display" id="selections2">
            Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø£ÙŠ Ù…Ù†Ø·Ù‚Ø© Ø¨Ø¹Ø¯
        </div>
    </div>
    
    <div class="container">
        <h2>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠ</h2>
        <button onclick="testProgrammaticControl()">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠ</button>
        <button onclick="testSearch()">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¨Ø­Ø«</button>
        <button onclick="testDataAccess()">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
        <div id="control-results" class="selections-display">
            Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§
        </div>
    </div>

    <script src="../dist/saudi-regions-widget.js"></script>
    <script>
        let widget1, widget2;
        let testResults = [];
        
        // Test data loading first
        async function testDataLoading() {
            const testItems = document.getElementById('test-items');
            
            try {
                // Test regions data
                const regionsResponse = await fetch('../dist/data/regions.min.json');
                if (regionsResponse.ok) {
                    const regionsData = await regionsResponse.json();
                    addTestResult('ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø·Ù‚', true, `ØªÙ… ØªØ­Ù…ÙŠÙ„ ${Object.keys(regionsData).length} Ù…Ù†Ø·Ù‚Ø©`);
                } else {
                    addTestResult('ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø·Ù‚', false, 'ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                }
                
                // Test cities data
                const citiesResponse = await fetch('../dist/data/regions-cities.min.json');
                if (citiesResponse.ok) {
                    const citiesData = await citiesResponse.json();
                    addTestResult('ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ù†', true, `ØªÙ… ØªØ­Ù…ÙŠÙ„ ${Object.keys(citiesData.cities || {}).length} Ù…Ø¯ÙŠÙ†Ø©`);
                } else {
                    addTestResult('ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ù†', false, 'ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                }
                
                // Test complete data
                const completeResponse = await fetch('../dist/data/complete.min.json');
                if (completeResponse.ok) {
                    const completeData = await completeResponse.json();
                    addTestResult('ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©', true, `ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©`);
                } else {
                    addTestResult('ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ§Ù…Ù„Ø©', false, 'ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                }
                
            } catch (error) {
                addTestResult('Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', false, error.message);
            }
            
            document.getElementById('loading-test').style.display = 'none';
            document.getElementById('test-results').style.display = 'block';
            
            // Start widget tests after data loading test
            startWidgetTests();
        }
        
        function addTestResult(testName, passed, details) {
            const testItems = document.getElementById('test-items');
            const testItem = document.createElement('div');
            testItem.className = `test-item ${passed ? 'test-pass' : 'test-fail'}`;
            testItem.innerHTML = `
                <strong>${passed ? 'âœ…' : 'âŒ'} ${testName}</strong><br>
                <small>${details}</small>
            `;
            testItems.appendChild(testItem);
        }
        
        function startWidgetTests() {
            // Widget 1: Complete cascading selects
            widget1 = new SaudiRegionsWidget({
                dataLevel: 'complete',
                language: 'ar',
                rtl: true,
                dataUrl: '../dist/data/'
            });
            
            widget1.on('ready', function() {
                document.getElementById('loading1').style.display = 'none';
                document.getElementById('widget1').style.display = 'block';
                widget1.createCascadingSelects('widget1');
                addTestResult('Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', true, 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø¨Ù†Ø¬Ø§Ø­');
            });
            
            widget1.on('regionChanged', function(data) {
                updateSelections('selections1');
                addTestResult('ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø©', true, `ØªÙ… Ø§Ø®ØªÙŠØ§Ø±: ${data.region.name_ar}`);
            });
            
            widget1.on('cityChanged', function(data) {
                updateSelections('selections1');
                addTestResult('ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©', true, `ØªÙ… Ø§Ø®ØªÙŠØ§Ø±: ${data.city.name_ar}`);
            });
            
            widget1.on('districtChanged', function(data) {
                updateSelections('selections1');
                addTestResult('ØªØºÙŠÙŠØ± Ø§Ù„Ø­ÙŠ', true, `ØªÙ… Ø§Ø®ØªÙŠØ§Ø±: ${data.district.name_ar}`);
            });
            
            widget1.on('error', function(error) {
                document.getElementById('loading1').innerHTML = 
                    '<div class="error">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ' + error.message + '</div>';
                addTestResult('Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©', false, error.message);
            });
            
            // Widget 2: Regions only
            widget2 = new SaudiRegionsWidget({
                dataLevel: 'regions',
                language: 'ar',
                rtl: true,
                dataUrl: '../dist/data/'
            });
            
            widget2.on('ready', function() {
                document.getElementById('loading2').style.display = 'none';
                document.getElementById('widget2').style.display = 'block';
                const select = widget2.createRegionSelect('widget2');
                addTestResult('Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚', true, 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø¨Ù†Ø¬Ø§Ø­');
                
                select.addEventListener('change', function(e) {
                    const regionId = e.target.value;
                    const region = widget2.getRegionById(regionId);
                    document.getElementById('selections2').innerHTML = 
                        regionId ? JSON.stringify(region, null, 2) : 'Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø£ÙŠ Ù…Ù†Ø·Ù‚Ø© Ø¨Ø¹Ø¯';
                    
                    if (regionId) {
                        addTestResult('Ø§Ø®ØªÙŠØ§Ø± Ù…Ù†Ø·Ù‚Ø©', true, `ØªÙ… Ø§Ø®ØªÙŠØ§Ø±: ${region.name_ar}`);
                    }
                });
            });
            
            widget2.on('error', function(error) {
                document.getElementById('loading2').innerHTML = 
                    '<div class="error">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ' + error.message + '</div>';
                addTestResult('Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚', false, error.message);
            });
        }
        
        function updateSelections(elementId) {
            const selections = widget1.getSelections('widget1');
            document.getElementById(elementId).innerHTML = JSON.stringify(selections, null, 2);
        }
        
        function testProgrammaticControl() {
            if (!widget1 || !widget1.isLoaded) {
                document.getElementById('control-results').textContent = 'Ø§Ù„Ù…ÙƒØªØ¨Ø© ØºÙŠØ± Ø¬Ø§Ù‡Ø²Ø© Ø¨Ø¹Ø¯';
                return;
            }
            
            try {
                // Test setting Riyadh
                widget1.setSelections('widget1', { region: 1, city: 3 });
                
                setTimeout(() => {
                    const selections = widget1.getSelections('widget1');
                    document.getElementById('control-results').textContent = 
                        'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠ - ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø±ÙŠØ§Ø¶:\n' + JSON.stringify(selections, null, 2);
                    addTestResult('Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠ', true, 'ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø±ÙŠØ§Ø¶ Ø¨Ø±Ù…Ø¬ÙŠØ§Ù‹');
                }, 500);
                
            } catch (error) {
                document.getElementById('control-results').textContent = 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠ: ' + error.message;
                addTestResult('Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠ', false, error.message);
            }
        }
        
        function testSearch() {
            if (!widget2 || !widget2.isLoaded) {
                document.getElementById('control-results').textContent = 'Ø§Ù„Ù…ÙƒØªØ¨Ø© ØºÙŠØ± Ø¬Ø§Ù‡Ø²Ø© Ø¨Ø¹Ø¯';
                return;
            }
            
            try {
                const results = widget2.search('Ø§Ù„Ø±ÙŠØ§Ø¶');
                document.getElementById('control-results').textContent = 
                    'Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† "Ø§Ù„Ø±ÙŠØ§Ø¶":\n' + JSON.stringify(results, null, 2);
                addTestResult('Ø§Ù„Ø¨Ø­Ø«', true, `ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${results.length} Ù†ØªÙŠØ¬Ø©`);
            } catch (error) {
                document.getElementById('control-results').textContent = 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨Ø­Ø«: ' + error.message;
                addTestResult('Ø§Ù„Ø¨Ø­Ø«', false, error.message);
            }
        }
        
        function testDataAccess() {
            if (!widget1 || !widget1.isLoaded) {
                document.getElementById('control-results').textContent = 'Ø§Ù„Ù…ÙƒØªØ¨Ø© ØºÙŠØ± Ø¬Ø§Ù‡Ø²Ø© Ø¨Ø¹Ø¯';
                return;
            }
            
            try {
                const region = widget1.getRegionById(1);
                const city = widget1.getCityById(3);
                
                const results = {
                    region: region,
                    city: city,
                    version: SaudiRegionsWidget.getVersion()
                };
                
                document.getElementById('control-results').textContent = 
                    'Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª:\n' + JSON.stringify(results, null, 2);
                addTestResult('Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª', true, 'ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
            } catch (error) {
                document.getElementById('control-results').textContent = 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ' + error.message;
                addTestResult('Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª', false, error.message);
            }
        }
        
        // Start testing when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª...');
            testDataLoading();
        });
    </script>
</body>
</html>

